# 作用域和闭包

## 什么是作用域
作用域是一套规则，用于确定何处如何查找变量
1. js其实可以说是一门编译语言(与传统编译语言不同，js编译到执行时间间隔短，会涉及到很多优化)
2. 编译原理：分词/词法分析、 解析/语法分析、 转化为可执行代码
3. 参与者：引擎、编译器、作用域
4. 引擎负责： 编译阶段 -> 执行阶段
5. 编译过程中：  
        LHS(左值查询)：取到变量的容器   
        RHS(非左值查询)：获取变量的值  
6. 作用域嵌套：块或函数嵌套时出现
7. Error：   
        LHS：未找到时会创建一个全局变量（非严格模式）  
        RHS：ReferenceError  
        TypeError代表作用域判别成功了，但是对结果的操作不合法

## 词法作用域
词法阶段定义的作用域(词所在的位置决定的作用域)
1. 引擎利用作用域的结构来查找标识符
2. 虽是词法阶段定义的作用域(与写代码位置有关)，但是可以在运行时修改(eval、with)，这会损失性能
3. 代码运行时，eval中的代码会像原来就在那一样，修改词法作用域
4. `with(obj){}` 会将`obj`的属性做为标识符添加到`{}`中，创建一个全新的作用域，而其中的声明会被添加到`with`所处的函数作用域中
5. 函数所在的作用域只决定于其定义的位置
