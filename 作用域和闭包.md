# 作用域和闭包

## 什么是作用域
作用域是一套规则，用于确定何处如何查找变量
1. js其实可以说是一门编译语言(与传统编译语言不同，js编译到执行时间间隔短，会涉及到很多优化)
2. 编译原理：分词/词法分析、 解析/语法分析、 转化为可执行代码
3. 参与者：引擎、编译器、作用域
4. 引擎负责： 编译阶段 -> 执行阶段
5. 编译过程中：  
        LHS(左值查询)：取到变量的容器   
        RHS(非左值查询)：获取变量的值  
6. 作用域嵌套：块或函数嵌套时出现
7. Error：   
        LHS：未找到时会创建一个全局变量（非严格模式）  
        RHS：ReferenceError  
        TypeError代表作用域判别成功了，但是对结果的操作不合法

## 词法作用域
词法阶段定义的作用域(词所在的位置决定的作用域)
1. 引擎利用作用域的结构来查找标识符
2. 虽是词法阶段定义的作用域(与写代码位置有关)，但是可以在运行时修改(eval、with)，这会损失性能
3. 代码运行时，eval中的代码会像原来就在那一样，修改词法作用域
4. `with(obj){}` 会将`obj`的属性做为标识符添加到`{}`中，创建一个全新的作用域，而其中的声明会被添加到`with`所处的函数作用域中
5. 函数所在的作用域只决定于其定义的位置

## 函数作用域 & 块作用域
软件设计中，应该最小限度的暴露必要内容，而将其他内容‘隐藏’起来（eg：模块和对象的API设计）  
1. 规避冲突：  
        一个程序中的多个第三方库，都是将功能作为对象熟悉来暴露   
        使用模块管理，所有标识符都会在自己的私有，无冲突的作用域中   
2. 只为了隐藏一段程序，而不污染所在作用域，使用匿名IIFE   
3. 函数表达式：  
        函数声明会将名称标识符绑定在所在作用域   
        函数表达式会将名称标识符绑定在自身函数中   
4.
